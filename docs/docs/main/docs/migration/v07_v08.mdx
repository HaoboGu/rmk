# From v0.7 to v0.8

RMK v0.8 is a major release with lots of updates and improvements. The key changes in v0.8 include:

- **Dependency upgrades**: Updated many dependencies to their latest versions, including `esp-hal` v1.0, `trouble-host` v0.5, and others.

- **Tap-hold system refactoring**: Introduced the new `Morse` operation â€” a superset of tap-hold and tap-dance functionalities.

- **Simplified matrix configuration**: Replaced `input/output_pins` with `row/col_pins` in `keyboard.toml` and removed the `col2row` feature from `Cargo.toml`, making matrix setup more intuitive.

- **Dongle support**: Reintroduced dongle support for split keyboards.

- **Enhanced configuration**: Improved structure and options in `keyboard.toml` for clearer and more efficient configuration management.

- **General fixes and improvements**: Numerous bug fixes and refinements across the codebase.

## `Cargo.toml` Update

In `Cargo.toml`, there are 4 main updates:

1. Update `rmk` version to v0.8, update `rmk`'s feature gate
2. Update `embassy-*` dependencies and HALs
3. Remove patched dependnecies in `[patch.crates-io]`
4. Use patched version for `cyw43`

```diff
# Update the version of `rmk` and its feature gates
- rmk = { version = "0.7", features = [
+ rmk = { version = "0.8", features = [
    "nrf52840_ble",
    "split",
    "async_matrix",
    "adafruit_bl",
-   "rapid_debouncer" # If applicable
-   "col2row" # If applicable
-   "bidirectional" # If applicable
] }

# Remove patched dependencies
- [patch.crates-io]
- embassy-sync = { git = "https://github.com/embassy-rs/embassy.git", rev = "f35aa4005a63e8d478b2b95aaa2bfb316b72dece" }
- embassy-futures = { git = "https://github.com/embassy-rs/embassy.git", rev = "f35aa4005a63e8d478b2b95aaa2bfb316b72dece" }
- embassy-executor = { git = "https://github.com/embassy-rs/embassy.git", rev = "f35aa4005a63e8d478b2b95aaa2bfb316b72dece" }
- trouble-host = { git = "https://github.com/embassy-rs/trouble", rev = "90c6359" }
- embassy-nrf = { git = "https://github.com/embassy-rs/embassy.git", rev = "f35aa4005a63e8d478b2b95aaa2bfb316b72dece" }
- embassy-time = { git = "https://github.com/embassy-rs/embassy.git", rev = "f35aa4005a63e8d478b2b95aaa2bfb316b72dece" }
- embassy-usb = { git = "https://github.com/embassy-rs/embassy.git", rev = "f35aa4005a63e8d478b2b95aaa2bfb316b72dece" }
- embassy-embedded-hal = { git = "https://github.com/embassy-rs/embassy.git", rev = "f35aa4005a63e8d478b2b95aaa2bfb316b72dece" }
- nrf-sdc = { git = "https://github.com/alexmoon/nrf-sdc.git", rev = "7be9b853e15ca0404d65c623d1ec5795fd96c204" }
- nrf-mpsl = { git = "https://github.com/alexmoon/nrf-sdc.git", rev = "7be9b853e15ca0404d65c623d1ec5795fd96c204" }
- trouble-host = { git = "https://github.com/embassy-rs/trouble", rev = "90c6359" }
- embassy-rp = { git = "https://github.com/embassy-rs/embassy.git", rev = "f35aa4005a63e8d478b2b95aaa2bfb316b72dece" }
- cyw43 = { git = "https://github.com/embassy-rs/embassy.git", rev = "f35aa4005a63e8d478b2b95aaa2bfb316b72dece" }
- cyw43-pio = { git = "https://github.com/embassy-rs/embassy.git", rev = "f35aa4005a63e8d478b2b95aaa2bfb316b72dece" }
- sequential-storage = { git = "https://github.com/tweedegolf/sequential-storage", rev = "4e9abcec36c259cb2c30840649ff8f9a6b6fcafc" } # Tmp workaround for https://github.com/tweedegolf/sequential-storage/issues/81
- trouble-host = { git = "https://github.com/embassy-rs/trouble", rev = "90c6359" }

# Update all embassy-* dependencies in your `Cargo.toml`.
# Keep existing feature gates unchanged unless otherwise specified.
- embassy-executor = { version = "0.7.0" }
+ embassy-executor = { version = "0.9" }
- embassy-time = { version = "0.4", }
+ embassy-time = { version = "0.5" }
- embassy-nrf = { version = "0.3.1" }
+ embassy-nrf = { version = "0.8" }
- embassy-rp = { version = "0.4" }
+ embassy-rp = { version = "0.8" }
- cyw43 = { version = "0.3.0", features = ["defmt", "firmware-logs", "bluetooth"] }
+ cyw43 = { version = "0.5", features = ["defmt", "firmware-logs", "bluetooth"] }
- cyw43-pio = { version = "0.4.0", features = ["defmt"] }
+ cyw43-pio = { version = "0.8.0", features = ["defmt"] }

# For nRF, update nrf-sdc and nrf-mpsl to git version
- nrf-sdc = { version = "0.1.0", default-features = false, ..
+ nrf-sdc = { git = "https://github.com/alexmoon/nrf-sdc", rev = "11d5c3c", ..
- nrf-mpsl = { version = "0.1.0", default-features = false, ..
+ nrf-mpsl = { git = "https://github.com/alexmoon/nrf-sdc", rev = "11d5c3c", ..

# For Pico W, patch cyw43, and embassy-time-*
+ [patch.crates-io]
+ cyw43 = { git = "https://github.com/embassy-rs/embassy", rev = "faacad6" }
+ embassy-time-driver = { git = "https://github.com/embassy-rs/embassy", rev = "faacad6" }
+ embassy-time = { git = "https://github.com/embassy-rs/embassy", rev = "faacad6" }
```